<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fancy QR Generator + Scanner</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  text-align: center;
  padding: 20px;
  background: linear-gradient(135deg,#fdfbfb,#ebedee);
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}
input, select, button {
  padding: 10px;
  margin: 5px 0;
  width: 90%;
  max-width: 320px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 16px;
}
canvas {
  margin-top: 15px;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0,0,0,0.3);
  background: #fff;
}
h2 { color: #00796b; font-size: 22px; margin-bottom: 10px; }
.logo-buttons img {
  width: 40px;
  height: 40px;
  margin: 5px;
  cursor: pointer;
  border-radius: 8px;
  border: 2px solid transparent;
  transition: border 0.2s;
}
.logo-buttons img.selected { border: 2px solid #00796b; }
a.download-link { display: block; margin-top: 10px; font-weight: bold; color: #ff5722; word-break: break-all; text-decoration: none; }
footer {
  margin-top: auto;
  padding: 15px 0;
  font-family: 'Cursive', sans-serif;
  font-size: 18px;
  color: #ff4081;
  letter-spacing: 1px;
  text-shadow: 1px 1px 2px #00000050;
}
footer a { color: #ff4081; text-decoration: none; }
footer a:hover { text-decoration: underline; }

/* Scanner Styles */
#scannerContainer {
  display:none;
  position: relative;
  width: 320px;
  margin: 20px auto;
}
#qr-video {
  width: 100%;
  border-radius: 12px;
  box-shadow: 0 0 15px rgba(0,0,0,0.4);
}
#stopScanBtn {
  position: absolute;
  top: 10px;
  right: 10px;
  background: red;
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
}

/* Modal */
#scanModal {
  position: fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  display:flex; align-items:center; justify-content:center;
  z-index:2000; flex-direction:column; color:white;
}
#scanModalContent {
  background:#fff; color:#333; padding:25px;
  border-radius:15px; text-align:center;
  width:80%; max-width:350px;
}
#scanModalContent button {
  padding:12px 20px; margin-top:15px; border:none;
  border-radius:8px; font-size:16px;
  background:linear-gradient(135deg,#00c6ff,#0072ff);
  color:white; cursor:pointer;
  box-shadow:0 4px 10px rgba(0,0,0,0.3);
}
</style>
</head>
<body>
<h2>Fancy QR Generator</h2>

<select id="type">
  <option value="text">Text</option>
  <option value="url">Link/URL</option>
  <option value="wifi">WiFi</option>
  <option value="phone">Phone Number</option>
  <option value="whatsapp">WhatsApp</option>
</select>
<br>
<input type="text" id="data" placeholder="Enter text, link, WiFi, phone, or WhatsApp"><br>

<label>Gradient:</label><br>
<select id="gradientPreset">
  <option value="#ff5722,#4caf50">Orange â†’ Green</option>
  <option value="#2196f3,#9c27b0">Blue â†’ Purple</option>
  <option value="#f44336,#ffeb3b">Red â†’ Yellow</option>
  <option value="#ff0080,#ff8c00">Pink â†’ Orange</option>
  <option value="#00bcd4,#8e24aa">Cyan â†’ Violet</option>
  <option value="#4caf50,#ffeb3b">Green â†’ Yellow</option>
  <option value="#ff5722,#9c27b0">Orange â†’ Purple</option>
  <option value="#3f51b5,#2196f3">Indigo â†’ Blue</option>
  <option value="#e91e63,#ff9800">Pink â†’ Orange</option>
  <option value="#ff0000,#00ff00,#0000ff">Rainbow</option>
</select><br>

<label>Logo:</label>
<div class="logo-buttons">
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" data-logo>
  <img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Instagram_logo_2016.svg" data-logo>
  <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/YouTube_icon_%282013-2017%29.png" data-logo>
  <img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg" data-logo>
  <img src="https://upload.wikimedia.org/wikipedia/commons/a/ab/Android_O_Preview_Logo.png" data-logo>
  <img src="https://upload.wikimedia.org/wikipedia/commons/1/12/Generic_QR_code_icon.png" data-logo>
</div>
<input type="text" id="customLogo" placeholder="Or custom logo URL"><br>

<button onclick="generateQR()">Generate Fancy QR</button>

<canvas id="qrCanvas" width="300" height="300"></canvas>
<a id="downloadLink" class="download-link" href="#" target="_blank">Open QR to Save (long-press on mobile)</a>

<!-- Scanner Section -->
<h2 style="margin-top:30px;">QR Scanner</h2>
<div id="scannerContainer">
  <video id="qr-video"></video>
  <button id="stopScanBtn" onclick="stopScanner()">Stop</button>
</div>
<p id="scan-result">Scan result will appear here</p>

<!-- Modal -->
<div id="scanModal">
  <div id="scanModalContent">
    <h3>ðŸ“· QR Scanner</h3>
    <p>Click below to allow camera access and start scanning</p>
    <button onclick="startFromModal()">Start Scanning</button>
  </div>
</div>

<footer>
  Contact Developer - 
  <a href="https://www.instagram.com/_a.a.r.i.z07_?igsh=cDBtZWt0b3dqeXQy" target="_blank">
    _a.a.r.i.z07_
  </a>
</footer>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
<script>
const canvas = document.getElementById('qrCanvas');
const ctx = canvas.getContext('2d');
let selectedLogo = "";

// Logo select
document.querySelectorAll('[data-logo]').forEach(img=>{
  img.addEventListener('click', ()=>{
    document.querySelectorAll('[data-logo]').forEach(i=>i.classList.remove('selected'));
    img.classList.add('selected');
    selectedLogo = img.src;
  });
});

// Generate QR
function generateQR() {
  let type = document.getElementById('type').value;
  let input = document.getElementById('data').value.trim();
  let qrData = "";

  if(type==="wifi"){
    let parts = input.split(",");
    if(parts.length===3) qrData = `WIFI:S:${parts[0]};T:${parts[1]};P:${parts[2]};;`;
    else { alert("Enter WiFi as: SSID,WPA/WEP,password"); return; }
  } else if(type==="phone") qrData = `tel:${input}`;
  else if(type==="whatsapp") qrData = `https://wa.me/${input.replace(/\D/g,'')}`;
  else qrData = input;

  const gradientColors = document.getElementById('gradientPreset').value.split(",");

  QRCode.toCanvas(canvas, qrData, { 
    errorCorrectionLevel: 'H',
    margin:1,
    scale:6,
    color: { dark:"#000000", light:"#FFFFFF" }
  }, function(err){
    if(err){ alert("QR generation failed"); return; }

    const imgData = ctx.getImageData(0,0,canvas.width,canvas.height);
    const grad = ctx.createLinearGradient(0,0,canvas.width,canvas.height);
    for(let i=0;i<gradientColors.length;i++){
      grad.addColorStop(i/(gradientColors.length-1), gradientColors[i]);
    }
    for(let y=0;y<canvas.height;y++){
      for(let x=0;x<canvas.width;x++){
        const i = (y*canvas.width + x)*4;
        if(imgData.data[i] < 128){
          ctx.fillStyle = grad;
          ctx.fillRect(x,y,1,1);
        }
      }
    }

    let logoURL = document.getElementById('customLogo').value || selectedLogo;
    if(logoURL){
      let logo = new Image();
      logo.crossOrigin="anonymous";
      logo.src = logoURL;
      logo.onload = function(){
        let size = canvas.width*0.2;
        let x = (canvas.width - size)/2;
        let y = (canvas.height - size)/2;
        ctx.drawImage(logo,x,y,size,size);
        updateDownloadLink();
      }
    } else updateDownloadLink();
  });
}

function updateDownloadLink(){
  const link = document.getElementById('downloadLink');
  link.href = canvas.toDataURL("image/png");
  link.textContent = "Open QR to Save (long-press on mobile)";
}

// Scanner logic
let html5QrCode;
function startFromModal() {
  document.getElementById("scanModal").style.display = "none";
  document.getElementById("scannerContainer").style.display = "block";

  html5QrCode = new Html5Qrcode("qr-video");
  html5QrCode.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: 250 },
    qrCodeMessage => {
      document.getElementById("scan-result").textContent = "Result: " + qrCodeMessage;
    },
    errorMessage => {}
  );
}
function stopScanner(){
  if(html5QrCode){
    html5QrCode.stop().then(()=> {
      document.getElementById("scannerContainer").style.display = "none";
    });
  }
}
</script>
</body>
</html>
